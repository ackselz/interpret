<html lang="en">
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 4rem;
            font-family: monospace;
        }
        #data {
            padding: 4rem;
        }
        #resetButton {
            position: fixed; /* Changed from 'absolute' to 'fixed' */
            bottom: 1rem; /* 20px from the bottom of the viewport */
            right: 1rem; /* 20px from the right of the viewport */
            padding: 1.125rem 1.5rem; /* Padding for better button size */
            font-size: 1rem; /* Adjust font size for better readability */
            cursor: pointer; /* Changes the mouse cursor to pointer on hover */
        }
    </style>
    <body>
        <div id="data">
            >
        </div>
        <button id="resetButton">Reset</button>
        <script>
            const dataDiv = document.getElementById("data")

            resetButton = document.getElementById('resetButton');

            resetButton.addEventListener('click', function() { 
                dataDiv.innerHTML = ">";
            });

            var serverUrl;
            var scheme = "ws";

            if (location.protocol === "https:") {
                scheme += "s";
            }

            serverUrl = `${scheme}://${location.hostname}:${location.port}`;

            console.log(serverUrl);

            const initWS = () => {
                const ws = new WebSocket(serverUrl);

                ws.addEventListener('open', function (event) {
                    console.log(`connection made to server ${serverUrl} :`, event);
                });

                ws.addEventListener('close', function (event) {
                    console.log('connection closed:', event);
                    ws.close();
                    setTimeout(initWS, 2500);  // reconnect here
                });

                ws.addEventListener("message", ({ data }) => {
                    const currentContent = dataDiv.innerHTML;
                    dataDiv.innerHTML = currentContent + " " + data;

                    // Play the audio directly from the /{word}.mp3 route
                    const audioUrl = `/${data}.mp3`; // Construct the URL for the mp3 file
                    const audio = new Audio(audioUrl); // Create a new audio object with the URL
                    audio.play(); // Play the audio file
                });
            };

            initWS()
        </script>
    </body>
</html>
